(function(e,t){var n=e.jQuery||e.Cowboy||(e.Cowboy={}),r;n.throttle=r=function(e,r,i,s){function a(){function p(){u=+(new Date);i.apply(n,l)}function v(){o=t}var n=this,a=+(new Date)-u,l=arguments;if(s&&!o){p()}o&&clearTimeout(o);if(s===t&&a>e){p()}else{if(r!==true){o=setTimeout(s?v:p,s===t?e-a:e)}}}var o,u=0;if(typeof r!=="boolean"){s=i;i=r;r=t}if(n.guid){a.guid=i.guid=i.guid||n.guid++}return a};n.debounce=function(e,n,i){return i===t?r(e,n,false):r(e,i,n!==false)}})(this);(function(e,t,n){"use strict";function i(e){if(!e){return""}return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-")}e.fn.sorted=function(t){var r=e.extend({},e.fn.sorted.defaults,t),i=this.get(),s=false;if(!i.length){return[]}if(r.randomize){return e.fn.sorted.randomize(i)}if(r.by!==e.noop&&r.by!==null&&r.by!==n){i.sort(function(t,i){if(s){return 0}var o=r.by(e(t)),u=r.by(e(i));if(o===n&&u===n){s=true;return 0}if(o==="sortFirst"||u==="sortLast"){return-1}if(o==="sortLast"||u==="sortFirst"){return 1}return o<u?-1:o>u?1:0})}if(s){return this.get()}if(r.reverse){i.reverse()}return i};e.fn.sorted.defaults={reverse:false,by:null,randomize:false};e.fn.sorted.randomize=function(e){var t=e.length,n,r;if(!t){return e}while(--t){r=Math.floor(Math.random()*(t+1));n=e[r];e[r]=e[t];e[t]=n}return e};var r=0;var s=t.prefixed("transition");var o=t.prefixed("transitionDelay");var u=t.prefixed("transitionDuration");var a={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[s];var f=t.prefixed("transform");var l=i(f);var c=t.csstransforms&&t.csstransitions;var h=t.csstransforms3d;var p="shuffle";var d=function(t,n){var i=this;e.extend(i,d.options,n,d.settings);i.$container=t;i.$window=e(window);i.unique="shuffle_"+r++;i._fire("loading");i._init();i._fire("done")};d.prototype={_init:function(){var t=this,n,r=e.proxy(t._onResize,t),i=t.throttle?t.throttle(t.throttleTime,r):r,o=t.initialSort?t.initialSort:null;t._setVars();t._resetCols();t._addClasses();t._initItems();t.$window.on("resize."+p+"."+t.unique,i);n=t.$container.css(["paddingLeft","paddingRight","position","width"]);if(n.position==="static"){t.$container[0].style.position="relative"}t.offset={left:parseInt(n.paddingLeft,10)||0,top:parseInt(n.paddingTop,10)||0};t._setColumns(parseInt(n.width,10));t.shuffle(t.group,o);if(t.supported){setTimeout(function(){t._setTransitions();t.$container[0].style[s]="height "+t.speed+"ms "+t.easing},0)}},_addClasses:function(){var e=this;e.$container.addClass(p);e.$items.addClass("shuffle-item filtered");return e},_setVars:function(){var t=this;t.$items=t._getItems();t.isFluid=t.columnWidth&&typeof t.columnWidth==="function";if(t.columnWidth===0&&t.sizer!==null){t.columnWidth=t.sizer}if(typeof t.columnWidth==="string"){t.$sizer=t.$container.find(t.columnWidth)}else if(t.columnWidth&&t.columnWidth.nodeType&&t.columnWidth.nodeType===1){t.$sizer=e(t.columnWidth)}else if(t.columnWidth&&t.columnWidth.jquery){t.$sizer=t.columnWidth}if(t.$sizer&&t.$sizer.length){t.useSizer=true;t.sizer=t.$sizer[0]}return t},_filter:function(t,r){var i=this,s=r!==n,o=s?r:i.$items,u=e();t=t||i.lastFilter;i._fire("filter");if(e.isFunction(t)){o.each(function(){var n=e(this),r=t.call(n[0],n,i);if(r){u=u.add(n)}})}else{i.group=t;if(t!=="all"){o.each(function(){var n=e(this),r=n.data("groups"),s=i.delimeter&&!e.isArray(r)?r.split(i.delimeter):r,o=e.inArray(t,s)>-1;if(o){u=u.add(n)}})}else{u=o}}i._toggleFilterClasses(o,u);o=null;r=null;return u},_toggleFilterClasses:function(t,n){var r="concealed",i="filtered";t.filter(n).each(function(){var t=e(this);if(t.hasClass(r)){t.removeClass(r)}if(!t.hasClass(i)){t.addClass(i)}});t.not(n).each(function(){var t=e(this);if(!t.hasClass(r)){t.addClass(r)}if(t.hasClass(i)){t.removeClass(i)}})},_initItems:function(e){e=e||this.$items;return e.css(this.itemCss)},_updateItemCount:function(){this.visibleItems=this.$items.filter(".filtered").length;return this},_setTransition:function(e){var t=this;e.style[s]=l+" "+t.speed+"ms "+t.easing+", opacity "+t.speed+"ms "+t.easing;return e},_setTransitions:function(e){var t=this;e=e||t.$items;e.each(function(){t._setTransition(this)});return t},_setSequentialDelay:function(t){var n=this;if(!n.supported){return}e.each(t,function(t){this.style[o]="0ms,"+(t+1)*n.sequentialFadeDelay+"ms";e(this).one(a,function(){this.style[o]="0ms"})})},_getItems:function(){return this.$container.children(this.itemSelector)},_getPreciseDimension:function(t,n){var r;if(window.getComputedStyle){r=window.getComputedStyle(t,null)[n]}else{r=e(t).css(n)}return parseFloat(r)},_setColumns:function(e){var t=this,n=e||t.$container.width(),r=typeof t.gutterWidth==="function"?t.gutterWidth(n):t.useSizer?t._getPreciseDimension(t.sizer,"marginLeft"):t.gutterWidth,i;t.colWidth=t.isFluid?t.columnWidth(n):t.useSizer?t._getPreciseDimension(t.sizer,"width"):t.columnWidth||t.$items.outerWidth(true)||n;t.colWidth=t.colWidth||n;t.colWidth+=r;i=(n+r)/t.colWidth;if(Math.ceil(i)-i<.01){i=Math.ceil(i)}t.cols=Math.floor(i);t.cols=Math.max(t.cols,1);t.containerWidth=n},_setContainerSize:function(){var e=this,t=Math.max.apply(Math,e.colYs);e.$container.css("height",t+"px")},_fire:function(e,t){this.$container.trigger(e+"."+p,t&&t.length?t:[this])},_layout:function(t,n,r,i){var s=this;n=n||s.filterEnd;s.layoutTransitionEnded=false;e.each(t,function(o){var u=e(t[o]),a=Math.ceil(u.outerWidth(true)/s.colWidth);a=Math.min(a,s.cols);if(a===1){s._placeItem(u,s.colYs,n,r,i)}else{var f=s.cols+1-a,l=[],c,h;for(h=0;h<f;h++){c=s.colYs.slice(h,h+a);l[h]=Math.max.apply(Math,c)}s._placeItem(u,l,n,r,i)}});s._processStyleQueue();s._setContainerSize()},_resetCols:function(){var e=this.cols;this.colYs=[];while(e--){this.colYs.push(0)}},_reLayout:function(e,t){var n=this;e=e||n.filterEnd;n._resetCols();if(n.keepSorted&&n.lastSort){n.sort(n.lastSort,true,t)}else{n._layout(n.$items.filter(".filtered").get(),n.filterEnd,t)}},_placeItem:function(e,t,n,r,i){var s=this,o=Math.min.apply(Math,t),u=0;for(var a=0,f=t.length;a<f;a++){if(t[a]>=o-s.buffer&&t[a]<=o+s.buffer){u=a;break}}var l=s.colWidth*u,c=o;l=Math.round(l+s.offset.left);c=Math.round(c+s.offset.top);e.data({x:l,y:c});var h=o+e.outerHeight(true),p=s.cols+1-f;for(a=0;a<p;a++){s.colYs[u+a]=h}var d={from:"layout",$this:e,x:l,y:c,scale:1};if(r){d.skipTransition=true}else{d.opacity=1;d.callback=n}if(i){d.opacity=0}s.styleQueue.push(d)},_shrink:function(t,n){var r=this,i=t||r.$items.filter(".concealed"),s={},o=n||r.shrinkEnd;if(!i.length){return}r._fire("shrink");r.shrinkTransitionEnded=false;i.each(function(){var t=e(this),n=t.data();s={from:"shrink",$this:t,x:n.x,y:n.y,scale:.001,opacity:0,callback:o};r.styleQueue.push(s)})},_onResize:function(){var e=this,t;if(!e.enabled||e.destroyed){return}t=e.$container.width();if(t===e.containerWidth){return}e.resized()},transition:function(t){var r=this,i,s=function(){if(!r.layoutTransitionEnded&&t.from==="layout"){r._fire("layout");t.callback.call(r);r.layoutTransitionEnded=true}else if(!r.shrinkTransitionEnded&&t.from==="shrink"){t.callback.call(r);r.shrinkTransitionEnded=true}};t.callback=t.callback||e.noop;if(r.supported){if(t.scale===n){t.scale=1}if(h){i="translate3d("+t.x+"px, "+t.y+"px, 0) scale3d("+t.scale+", "+t.scale+", 1)"}else{i="translate("+t.x+"px, "+t.y+"px) scale("+t.scale+", "+t.scale+")"}if(t.x!==n){t.$this.css(f,i)}if(t.opacity!==n){t.$this.css("opacity",t.opacity)}t.$this.one(a,s)}else{var o={left:t.x,top:t.y,opacity:t.opacity};t.$this.stop(true).animate(o,r.speed,"swing",s)}},_processStyleQueue:function(){var t=this,n=t.styleQueue;e.each(n,function(e,n){if(n.skipTransition){t._skipTransition(n.$this[0],function(){t.transition(n)})}else{t.transition(n)}});t.styleQueue.length=0},shrinkEnd:function(){this._fire("shrunk")},filterEnd:function(){this._fire("filtered")},sortEnd:function(){this._fire("sorted")},_skipTransition:function(t,n,r){var i,s=t.style[u];t.style[u]="0ms";if(e.isFunction(n)){n()}else{t.style[n]=r}i=t.offsetWidth;t.style[u]=s},_addItems:function(e,t,r){var i=this,s,o;if(!i.supported){t=false}e.addClass("shuffle-item");i._initItems(e);i._setTransitions(e);i.$items=i._getItems();e.css("opacity",0);s=i._filter(n,e);o=s.get();i._updateItemCount();if(t){i._layout(o,null,true,true);if(r){i._setSequentialDelay(s)}i._revealAppended(s)}else{i._layout(o)}},_revealAppended:function(t){var n=this;setTimeout(function(){t.each(function(t,r){n.transition({from:"reveal",$this:e(r),opacity:1})})},n.revealAppendedDelay)},shuffle:function(e,t){var n=this;if(!n.enabled){return}if(!e){e="all"}n._filter(e);n.lastFilter=e;n._updateItemCount();n._resetCols();n._shrink();if(t){n.lastSort=t}n._reLayout()},sort:function(e,t,n){var r=this,i=r.$items.filter(".filtered").sorted(e);if(!t){r._resetCols()}r._layout(i,function(){if(t){r.filterEnd()}r.sortEnd()},n);r.lastSort=e},resized:function(e){if(this.enabled){if(!e){this._setColumns()}this._reLayout()}},layout:function(){this.update(true)},update:function(e){this.resized(e)},appended:function(e,t,n){t=t===false?false:true;n=n===false?false:true;this._addItems(e,t,n)},disable:function(){this.enabled=false},enable:function(e){this.enabled=true;if(e!==false){this.update()}},remove:function(e){if(!e.length||!e.jquery){return}var t=this;t._shrink(e,function(){var t=this;e.remove();setTimeout(function(){t.$items=t._getItems();t.layout();t._updateItemCount();t._fire("removed",[e,t]);e=null},0)});t._processStyleQueue();return t},destroy:function(){var e=this;e.$window.off("."+e.unique);e.$container.removeClass(p).removeAttr("style").removeData(p);e.$items.removeAttr("style").removeClass("concealed filtered shuffle-item");e.$window=null;e.$items=null;e.$container=null;e.$sizer=null;e.sizer=null;e.destroyed=true}};d.options={group:"all",speed:500,easing:"ease-in-out",itemSelector:"",sizer:null,gutterWidth:0,columnWidth:0,delimeter:null,buffer:0,initialSort:null,throttle:e.throttle||null,throttleTime:125,sequentialFadeDelay:0,supported:c};d.settings={$sizer:null,useSizer:false,itemCss:{position:"absolute",top:0,left:0},offset:{top:0,left:0},revealAppendedDelay:300,keepSorted:true,enabled:true,destroyed:false,styleQueue:[]};e.fn.shuffle=function(t){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e(this),i=r.data(p);if(!i){i=new d(r,t);r.data(p,i)}if(typeof t==="string"&&i[t]){i[t].apply(i,n)}})}})(jQuery,Modernizr)